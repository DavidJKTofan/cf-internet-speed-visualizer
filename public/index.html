<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Network Quality Monitoring</title>
		<meta
			name="description"
			content="Real-time network performance monitoring dashboard with comprehensive metrics including throughput, latency, packet loss, DNS resolution, and network path analysis."
		/>
		<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/date-fns@2.30.0/index.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
		<link rel="icon" href="/favicon.svg" type="image/svg+xml" />
		<link rel="stylesheet" href="styles.css" />
	</head>
	<body>
		<div class="header">
			<div class="header-content">
				<div class="logo">
					<div class="logo-icon">N</div>
					<h1>Network Quality Monitoring</h1>
				</div>
				<div class="header-meta">
					<div class="status-badge" id="statusBadge">
						<span class="status-dot"></span>
						<span id="statusText">Live</span>
					</div>
					<div class="last-updated" id="lastUpdated"></div>
				</div>
			</div>
		</div>

		<div class="container">
			<div id="error" class="error" style="display: none">
				<span class="error-icon">âš </span>
				<span id="errorText"></span>
			</div>

			<div id="loading" class="loading">
				<div class="spinner"></div>
				<div class="loading-text">Loading network data...</div>
			</div>

			<div id="emptyState" class="empty-state" style="display: none">
				<div class="empty-icon">ðŸ“Š</div>
				<div class="empty-title">No Data Available</div>
				<div class="empty-message">
					Run the local script to start collecting metrics. Data will appear here once measurements are uploaded.
				</div>
			</div>

			<div id="content" style="display: none">
				<div class="controls">
					<div class="control-group">
						<label class="control-label" for="timeRange">Time Range</label>
						<select id="timeRange">
							<option value="24">Last 24 Hours</option>
							<option value="168">Last 7 Days</option>
							<option value="720">Last 30 Days</option>
							<option value="all" selected>All Time</option>
						</select>
					</div>
				</div>

				<div class="highlights-grid" id="highlightsGrid"></div>

				<div class="stats-grid" id="statsGrid"></div>

				<div class="charts-grid">
					<div class="chart-container">
						<div class="chart-header">
							<div class="chart-title-container">
								<h2 class="chart-title">Throughput Analysis</h2>
								<div class="tooltip-trigger" id="throughput-tooltip-trigger">?</div>
							</div>
							<p class="chart-description">Download and upload rates from NetworkQuality and Speedtest.</p>
						</div>
						<canvas id="speedChart"></canvas>
					</div>

					<div class="chart-container">
						<div class="chart-header">
							<div class="chart-title-container">
								<h2 class="chart-title">Round-Trip Time (RTT)</h2>
								<div class="tooltip-trigger" id="rtt-tooltip-trigger">?</div>
							</div>
							<p class="chart-description">ICMP ping latency comparison. Lower is better.</p>
						</div>
						<canvas id="rttChart"></canvas>
					</div>

					<div class="chart-container">
						<div class="chart-header">
							<div class="chart-title-container">
								<h2 class="chart-title">Time to First Byte (TTFB)</h2>
								<div class="tooltip-trigger" id="ttfb-tooltip-trigger">?</div>
							</div>
							<p class="chart-description">End-to-end latency to US and EU endpoints via HTTPS.</p>
						</div>
						<canvas id="ttfbChart"></canvas>
					</div>

					<div class="chart-container">
						<div class="chart-header">
							<div class="chart-title-container">
								<h2 class="chart-title">Network Responsiveness</h2>
								<div class="tooltip-trigger" id="responsiveness-tooltip-trigger">?</div>
							</div>
							<p class="chart-description">Apple's RPM metric for real-world application performance.</p>
						</div>
						<canvas id="responsivenessChart"></canvas>
					</div>

					<div class="chart-container">
						<div class="chart-header">
							<div class="chart-title-container">
								<h2 class="chart-title">Packet Loss Rate</h2>
								<div class="tooltip-trigger" id="packet-loss-tooltip-trigger">?</div>
							</div>
							<p class="chart-description">Percentage of ICMP packets lost during transmission.</p>
						</div>
						<canvas id="packetLossChart"></canvas>
					</div>

					<div class="chart-container">
						<div class="chart-header">
							<div class="chart-title-container">
								<h2 class="chart-title">DNS Resolution</h2>
								<div class="tooltip-trigger" id="dns-tooltip-trigger">?</div>
							</div>
							<p class="chart-description">Time to resolve domain names to IP addresses for key domains.</p>
						</div>
						<canvas id="dnsChart"></canvas>
					</div>
				</div>

				<!-- MTR Table Section -->
				<div id="mtr-section" class="chart-container" style="display: none; margin-top: 1.5rem">
					<div class="chart-header">
						<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem">
							<h2 class="chart-title">Network Path Analysis (MTR) - Cloudflare</h2>
							<div class="control-group" style="margin: 0">
								<select id="mtrSelector" style="font-size: 0.8125rem; padding: 0.375rem 1.5rem 0.375rem 0.5rem">
									<option value="0">Latest</option>
								</select>
							</div>
						</div>
						<p class="chart-description">Full trace to Cloudflare (1.1.1.1), showing latency and loss at each network hop.</p>
						<p id="mtrTimestamp" class="chart-description" style="font-size: 0.75rem; color: var(--text-muted); margin-top: 0.25rem"></p>
					</div>
					<div id="mtrTableContainer"></div>
				</div>

				<!-- MTR Table Section for Google -->
				<div id="mtr-google-section" class="chart-container" style="display: none; margin-top: 1.5rem">
					<div class="chart-header">
						<h2 class="chart-title">Network Path Analysis (MTR) - Google</h2>
						<p class="chart-description">Full trace to Google (8.8.8.8), showing latency and loss at each network hop.</p>
					</div>
					<div id="mtrGoogleTableContainer"></div>
				</div>
			</div>
		</div>

		<div class="container methodology-section">
			<h2 class="section-title">Methodology</h2>
			<p class="section-description">
				Data is collected using a
				<a
					href="https://github.com/DavidJKTofan/cf-internet-speed-visualizer/blob/main/local_script/isp-speed.sh"
					target="_blank"
					rel="noreferrer noopener"
					>local script</a
				>
				that runs comprehensive tests against multiple endpoints. All measurements are performed from the client's network location.
			</p>
			<div class="methodology-grid">
				<div class="methodology-card">
					<h3>NetworkQuality</h3>
					<p>Apple's tool to measure uplink/downlink capacity and responsiveness (RPM) under load conditions.</p>
					<pre><code>networkQuality -c</code></pre>
				</div>
				<div class="methodology-card">
					<h3>Speedtest CLI</h3>
					<p>Ookla's official CLI for bandwidth measurements against the global Speedtest.net network.</p>
					<pre><code>speedtest --format=json</code></pre>
				</div>
				<div class="methodology-card">
					<h3>Ping (ICMP)</h3>
					<p>Standard ICMP echo requests measure round-trip time (RTT), jitter, and packet loss to infrastructure endpoints.</p>
					<ul>
						<li><strong>Cloudflare:</strong> <code>ping -c 10 1.1.1.1</code></li>
						<li><strong>Google:</strong> <code>ping -c 10 8.8.8.8</code></li>
					</ul>
				</div>
				<div class="methodology-card">
					<h3>MTR (My Traceroute)</h3>
					<p>
						Combines traceroute and ping to diagnose network path performance hop-by-hop, revealing routing issues and congestion points.
					</p>
					<ul>
						<li><strong>Cloudflare:</strong> <code>sudo mtr --json -n -c 5 1.1.1.1</code></li>
						<li><strong>Google:</strong> <code>sudo mtr --json -n -c 5 8.8.8.8</code></li>
					</ul>
				</div>
				<div class="methodology-card">
					<h3>Dig (DNS Lookup)</h3>
					<p>Direct DNS query timing tests against major resolvers using the Domain Information Groper tool.</p>
					<ul>
						<li><strong>Cloudflare DNS:</strong> <code>dig cloudflare.com @1.1.1.1 +stats</code></li>
						<li><strong>Google DNS:</strong> <code>dig google.com @8.8.8.8 +stats</code></li>
					</ul>
				</div>

				<div class="methodology-card">
					<h3>cURL (TTFB)</h3>
					<p>Time to First Byte (TTFB) is measured against geographically distributed endpoints to assess global connectivity.</p>
					<ul>
						<li><strong>US Endpoint:</strong> <code>curl -w "%{time_starttransfer}" https://us.dlsdemo.com</code></li>
						<li><strong>EU Endpoint:</strong> <code>curl -w "%{time_starttransfer}" https://eu.dlsdemo.com</code></li>
					</ul>
				</div>
			</div>
		</div>

		<div class="footer">
			<div class="footer-content">
				<div class="footer-links">
					<a
						href="https://github.com/DavidJKTofan/cf-internet-speed-visualizer"
						target="_blank"
						rel="noopener noreferrer"
						class="footer-link"
					>
						<svg class="footer-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" aria-hidden="true">
							<path
								d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"
							></path>
						</svg>
						<span>GitHub</span>
					</a>
				</div>
				<div class="footer-disclaimer">
					Metrics are collected from local measurements and may not reflect actual ISP guarantees. <br>Data is for informational and diagnostic
					purposes only.
				</div>
			</div>
		</div>
		<script src="scripts.js"></script>
	</body>
</html>
